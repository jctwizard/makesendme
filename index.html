<html>
<head>
<title>make send</title>
</head>

<style>
html
{
  background-color: coral;
  font-size: 3em;
}

body
{
  font-family: monospace;
  color: lightblue;
}

#inputBar
{
  padding-left: 2em;
  padding-top: 1em;
}

#newItem
{
  font-family: monospace;
  color: black;
  font-size: 1em;
}

#addItem
{
  font-family: monospace;
  color: black;
  font-size: 1em;
}

#title
{
  font-weight: bold;
  padding-left: 2em;
  padding-top: 1em;
}

#subtitle
{
  font-style: italic;
  text-decoration: underline;
  padding-left: 2em;
  padding-top: 1em;
}
</style>

<body onload="init()">

<div id="title">
  welome home!
</div>

<div id="inputBar">
  <input id="newItem" type="text" value=""></input>
  <button id="addItem" onclick="addNewItem();">add</button>
</div>

<div id="subtitle">

</div>

<ul id="list"></ul>

</body>

<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>

<script>

// Initialize Firebase
var config = {
  apiKey: "AIzaSyCtyO5e3BdcWxyR7YsKpTvA66dklMKDAcY",
  authDomain: "makesendme.firebaseapp.com",
  databaseURL: "https://makesendme.firebaseio.com",
  projectId: "makesendme",
  storageBucket: "makesendme.appspot.com",
  messagingSenderId: "593040807046"
};

var list;
var listParent;

function init()
{
  listParent = document.getElementById("list");

  firebase.initializeApp(config);

  updateItems();

  setInterval(function()
  {
    updateItems();
  }, 3000);
}

function updateItems()
{
  firebase.database().ref("bubbles").once("value").then(function(data) {
    list = data.val();
    displayItems();
  });
}

function displayItems()
{
  listParent.innerHTML = "";

  for (var itemIndex = Object.keys(list).length - 1; itemIndex >= 0; itemIndex--)
  {
    addItem(list[itemIndex.toString()], itemIndex);
  }
}

function addNewItem()
{
  updateItems();

  var item = document.getElementById("newItem").value;
  document.getElementById("newItem").value = "";

  list[(Object.keys(list).length).toString()] = {};
  list[(Object.keys(list).length - 1).toString()]["item"] = item;
  list[(Object.keys(list).length - 1).toString()]["scored"] = "scored";

  firebase.database().ref("list").set(list);

  displayItems();
}

function addBubble(bubble, index)
{
  var bubbleElement = document.createElement("li");
  bubbleElement.innerHTML = bubble["data"];
  bubbleElement.id = index.toString();
  bubbleElement.setAttribute("onclick", "openBubble(" + index.toString() + ")");

  listParent.appendChild(bubbleElement);
}

function openBubble(index)
{
  firebase.database().ref("list").set(list);

  displayBubbles();
}
</script>
</html>
